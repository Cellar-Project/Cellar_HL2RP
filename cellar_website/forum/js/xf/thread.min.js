'use strict';!function(e,h,k,l){XF.ThreadEditForm=XF.Element.newHandler({options:{itemSelector:null},$item:null,$inlineEdit:null,init:function(){this.$item=e(this.options.itemSelector);this.$item.length&&(this.$target.on("ajax-submit:before",XF.proxy(this,"beforeSubmit")),this.$target.on("ajax-submit:response",XF.proxy(this,"afterSubmit")),this.$inlineEdit=e('<input type="hidden" name="_xfInlineEdit" value="1" />'))},beforeSubmit:function(){this.$target.append(this.$inlineEdit)},afterSubmit:function(c,
a){if(!a.errors&&!a.exception){c.preventDefault();a.message&&XF.flashMessage(a.message,3E3);var b=this;XF.setupHtmlInsert(a.html,function(d,f,g){b.$item.replaceWith(d);g()});XF.hideParentOverlay(this.$target)}}});XF.QuickThread=XF.Element.newHandler({options:{focusActivate:".js-titleInput",focusActivateTarget:".js-quickThreadFields",focusActivateHref:null,insertTarget:".js-threadList",replaceTarget:".js-emptyThreadList"},xfInserter:null,activated:!1,loading:!1,init:function(){var c=this,a=e(this.options.focusActivate);
a.length&&(this.xfInserter=new XF.Inserter(a,{href:this.options.focusActivateHref,replace:this.options.focusActivateTarget,afterLoad:function(){setTimeout(function(){c.activated=!0;c.$target.trigger("draft:sync")},500)}}),a.on("focus",XF.proxy(function(b){if(e(this.options.replace).is(":empty")){var d={},f=c.$target.find(".js-prefixSelect");f.length&&(d.prefix_id=f.val());this.onEvent(b,d)}},this.xfInserter)));this.$target.on("ajax-submit:response",XF.proxy(this,"afterSubmit")).on("reset",XF.proxy(this,
"reset"));this.$target.on("draft:beforesave",function(b){c.activated||b.preventDefault()})},afterSubmit:function(c,a){if(!this.loading)if(this.loading=!0,a.errors||a.exception)this.loading=!1;else{c.preventDefault();a.redirect&&XF.redirect(a.redirect);var b=this;XF.setupHtmlInsert(a.html,function(d){XF.hideTooltips();d.hide();e(b.options.insertTarget)["asc"==b.options.direction?"append":"prepend"](d);e(b.options.replaceTarget).replaceWith(d);b.reset(null,function(){d.xfFadeDown();var f=b.$target.closest(".block-container").offset().top-
60;XF.smoothScroll(f,!1,null,!0);b.loading=!1})})}},reset:function(c,a){var b=e(this.options.focusActivateTarget),d=this;XF.hideTooltips();b.xfFadeUp(null,XF.proxy(function(){d.activated=!1;b.empty();c&&"reset"==c.type||this.$target.get(0).reset();"function"==typeof a&&a()},this))}});XF.Element.register("thread-edit-form","XF.ThreadEditForm");XF.Element.register("quick-thread","XF.QuickThread")}(jQuery,window,document);
